# Development Dockerfile for the app service
FROM ghcr.io/astral-sh/uv:alpine3.22

# Set work directory
WORKDIR /app

Add . /app

# Copy dependency files
COPY pyproject.toml uv.lock ./ 

# Create virtual environment and install dependencies as app user
# .venv is excluded from volume mount in docker-compose.dev.yml
RUN .venv/bin/uv sync --no-cache --locked

# Create logs directory
RUN mkdir -p /app/logs

# Expose port
EXPOSE 8000

# Set entrypoint to the new location
CMD ["uv", "run", "uvicorn", "app.main:app", "--host",  "0.0.0.0",  "--port" ,"8000" ,"--reload"]
